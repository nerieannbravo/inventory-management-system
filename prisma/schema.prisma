generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  // url      = env("DATABASE_URL")
  // url      = "postgresql://postgres:obGVLTjkBfaLNAuADJifzuVjTTEmpjcW@crossover.proxy.rlwy.net:36212/railway"
  url      = "postgresql://postgres:ahPlWkZoDRdvmKptXQPXqSHplILdXlbd@hopper.proxy.rlwy.net:29736/railway"
}

model InventoryItem {
  item_id       String          @id @db.VarChar(10)
  category_id   String
  item_name     String          @db.VarChar(100)
  unit_measure  String          @db.VarChar(20)
  current_stock Int             @default(0)
  reorder_level Int             @default(0)
  status        InventoryStatus
  date_created  DateTime        @default(now())
  date_updated  DateTime        @updatedAt
  isdeleted     Boolean         @default(false)
  created_by    String
  batches       Batch[]
  employeeRequests EmployeeRequest[]
  category      Category        @relation(fields: [category_id], references: [category_id])

  @@map("inventory_items")
}

model Batch {
  batch_id           String        @id @db.VarChar(10)
  item_id            String
  f_item_id          String          @db.VarChar(10)
  usable_quantity    Int           @default(0)
  defective_quantity Int           @default(0)
  missing_quantity   Int           @default(0)
  expiration_date    DateTime?
  date_created       DateTime      @default(now())
  created_by         String
  isdeleted          Boolean       @default(false)
  inventoryItem      InventoryItem @relation(fields: [item_id], references: [item_id])

  @@map("batches")
}

model Category {
  category_id    String          @id @db.VarChar(10)
  category_name  String          @unique @db.VarChar(100)
  date_created   DateTime        @default(now())
  isdeleted      Boolean         @default(false)
  inventoryItems InventoryItem[]

  @@map("categories")
}

model EmployeeRequest {
  request_id    String          @id @db.VarChar(10)
  item_id       String            
  emp_id        String          @db.VarChar(10)
  request_type  RequestType     
  quantity      Int
  req_purpose String          @db.VarChar(255)
  status        RequestStatus   
  expected_return_date DateTime?
  actual_return_date DateTime?
  date_created  DateTime        @default(now())
  date_updated  DateTime        @updatedAt
  isdeleted     Boolean         @default(false)
  created_by    Int
  inventoryItem InventoryItem   @relation(fields: [item_id], references: [item_id])

  @@map("employee_requests")
}

enum InventoryStatus {
  LOW_STOCK
  AVAILABLE
  OUT_OF_STOCK
  UNDER_MAINTENANCE
  EXPIRED
}

enum RequestType {
  BORROW
  CONSUME
}

enum RequestStatus {
  RETURNED
  NOT_RETURNED
  CONSUMED
}
